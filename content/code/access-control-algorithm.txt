FUNCTION ExecuteQuery(i, q, QPK)
  INPUT:
    client identification i
    quad pattern query q
    QPK a hashmap relating quads to policies and keys
  OUTPUT:
    query results R
R = {}
IF i not verified
  RETURN {}
p = QPK(q).p
IF ! AllowedAccess(p, i, q)
  RETURN {}
ELSE
  R = ExecuteQueryWithAccessControl(i, q, p)
RETURN R
