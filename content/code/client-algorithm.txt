FUNCTION SelectSources(q, K, S, U)
  INPUT:
    quad pattern query q
    access keys K
    summary for each quad component: S.subject, S.predicate, S.object S.graph
    list of sources U
  OUTPUT:
    list of selected sources
FOREACH c in [subject, predicate, object, graph]
  t = q.c
  IF t not variable
    FOREACH k in K
      IF ! Summary_Contains(S.c, t, k, 0)
        RETURN []
      FOREACH u in U
        IF ! Summary_Contains(S.c, t, k, u)
          remove u from U
RETURN U
