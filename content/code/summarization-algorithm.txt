FUNCTION Summarize(Q, u, K, pk)
  INPUT:
    list of quads Q
    URI u of the file
    all applicable keys K for quads in the file
    predicate pk(k, q) for checking whether or not a key applies to a quad
  OUTPUT:
    summaries S for each quad component
      (S_subject, S_predicate, S_object, S_graph)
initialize empty summaries S =
  (S_subject, S_predicate, S_object, S_graph)
FOREACH q in Q
  FOREACH c in (subject, predicate, object, graph)
    FOREACH k in K
      IF pk(k, q)
        S_c = Summary_Add(S_c, q[c], k, u)
RETURN S
